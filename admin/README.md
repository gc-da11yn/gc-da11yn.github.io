<div lang="fr">

([Français](#francais))

</div>

# Decap CMS Admin

This folder contains the Decap CMS (Content Management System) configuration for the Digital Accessibility Toolkit.

## Files

- **index.html**: The CMS admin interface entry point
- **config.yml**: ⚠️ **Auto-generated file** - DO NOT EDIT MANUALLY
  - Generated by `scripts/generate-cms-config.js`
  - Regenerated on every build (`npm run build`)
  - Ignored by git (not committed to repository)
  - Based on data files: `src/_data/tagList.js`, `roles.js`, `resourceTopics.js`

## Access

- **Production**: Navigate to `https://a11ycanada.netlify.app/admin/` (requires GitHub account with repository access)
- **Local Development**: Navigate to `http://localhost:8080/admin/` (requires local backend setup)

## Authentication

The CMS uses **GitHub OAuth** via Netlify's OAuth provider:

- **Login**: Click "Login with GitHub"
- **Requirements**: GitHub account with write access to `gc-da11yn/gc-da11yn.github.io`
- **Workflow**: Changes create pull requests; merge PRs to deploy
- **No Netlify Identity**: Removed in favor of direct GitHub authentication

## What the CMS Manages

### Resources Collection

Individual resource items for the Additional Resources page with bilingual support:

- **Location**: `src/resources/en/` and `src/resources/fr/`
- **Structure**: Frontmatter-only markdown files
- **i18n**: Single entry point with language tabs for title/description
- **Fields**: title, description, url, topic (full labels), resourceType, parentResource, internalLinks, languageAvailability
- **Topics**: 6 categories with full labels ("Learning", "Development", etc.), converted to keys by collections plugin
- **Parent/Child**: Hierarchical resources via resourceType (standard/parent/child) and parentResource relation
- **View Controls**: Filter by topic with view_filters, group by topic with view_groups
- **Display**: Dynamic templates query collections and display alphabetically by topic with parent/child nesting

## Local Development

### For Regular Development (no CMS needed)

```bash
npm start          # Start dev server
```

### For CMS Development (with local backend)

```bash
npm run start-cms  # Starts decap-server + dev server in parallel
```

This command automatically:

1. Generates `config.yml` with `local_backend: true`
2. Starts `npx decap-server` on port 8081
3. Starts Eleventy dev server
4. Access CMS at: `http://localhost:{PORT}/admin/`
   - Port is auto-detected (usually 8080, but may vary if port is in use)
   - Check console output for actual URL

### Manual Config Generation

```bash
npm run cms:config           # Production mode (no local backend)
npm run cms:config -- --local # Local mode (with local backend)
```

**Note**: Config is auto-generated on `npm run build` and `npm run start-cms`

## Key Features

- **Bilingual entry**: Add resources in both EN and FR with language tabs
- **Auto-toggle**: Cross-language linking automatically generated
- **Language availability**: Mark resources as "both", "en", or "fr"
- **Topic organization**: 6 topics with full labels in CMS, converted to keys in collections
- **Parent/child resources**: Create hierarchical resource collections (parent with related children)
- **View controls**: Filter resources by topic or toggle "Group by Topic" for organized display
- **Internal links flag**: Indicate GC network-only resources
- **Pull request workflow**: Changes create PRs for review before deployment
- **Individual attribution**: GitHub accounts provide clear authorship of changes

## Documentation

See complete documentation:

- **Implementation details**: `/docs/implementation/decap-cms-implementation.md`
- **Quick setup guide**: `/DECAP-CMS-SETUP.md`
- **Decap CMS docs**: [decapcms.org/docs](https://decapcms.org/docs/)

---

<div lang="fr" id="francais">

([English](#decap-cms-admin))

</div>

# Administration de Decap CMS

Ce dossier contient la configuration du système de gestion de contenu (CMS) Decap pour la Boîte à outils de l'accessibilité numérique.

## Fichiers

- **index.html** : Point d'entrée de l'interface d'administration CMS
- **config.yml** : ⚠️ **Fichier auto-généré** - NE PAS MODIFIER MANUELLEMENT
  - Généré par `scripts/generate-cms-config.js`
  - Régénéré à chaque construction (`npm run build`)
  - Ignoré par git (non validé dans le dépôt)
  - Basé sur les fichiers de données : `src/_data/tagList.js`, `roles.js`, `resourceTopics.js`

## Accès

- **Production** : Naviguez vers `https://a11ycanada.netlify.app/admin/` (nécessite un compte GitHub avec accès au dépôt)
- **Développement local** : Naviguez vers `http://localhost:8080/admin/` (nécessite la configuration du backend local)

## Authentification

Le CMS utilise **GitHub OAuth** via le fournisseur OAuth de Netlify :

- **Connexion** : Cliquez sur "Login with GitHub"
- **Exigences** : Compte GitHub avec accès en écriture à `gc-da11yn/gc-da11yn.github.io`
- **Flux de travail** : Les modifications créent des pull requests; fusionner les PR pour déployer
- **Pas de Netlify Identity** : Supprimé en faveur de l'authentification GitHub directe

## Authentification

Le CMS utilise **GitHub OAuth** via le fournisseur OAuth de Netlify :

- **Connexion** : Cliquez sur "Login with GitHub"
- **Exigences** : Compte GitHub avec accès en écriture à `gc-da11yn/gc-da11yn.github.io`
- **Flux de travail** : Les modifications créent des pull requests; fusionner les PR pour déployer
- **Pas de Netlify Identity** : Supprimé en faveur de l'authentification GitHub directe

## Ce que le CMS gère

### Collection Ressources

Éléments de ressources individuels pour la page Ressources additionnelles avec support bilingue :

- **Emplacement** : `src/resources/en/` et `src/resources/fr/`
- **Structure** : Fichiers markdown frontmatter uniquement
- **i18n** : Point d'entrée unique avec onglets de langue pour titre/description
- **Champs** : title, description, url, topic (étiquettes complètes), resourceType, parentResource, internalLinks, languageAvailability
- **Sujets** : 6 catégories avec étiquettes complètes ("Apprentissage", "Développement", etc.), converties en clés par plugin collections
- **Parent/Enfant** : Ressources hiérarchiques via resourceType (standard/parent/child) et relation parentResource
- **Contrôles d'affichage** : Filtrer par sujet avec view_filters, regrouper par sujet avec view_groups
- **Affichage** : Les modèles dynamiques interrogent les collections et affichent alphabétiquement par sujet avec imbrication parent/enfant

## Développement local

### Pour le développement régulier (CMS non nécessaire)

```bash
npm start          # Démarrer le serveur de développement
```

### Pour le développement CMS (avec backend local)

```bash
npm run start-cms  # Démarre decap-server + serveur de développement en parallèle
```

Cette commande automatiquement :

1. Génère `config.yml` avec `local_backend: true`
2. Démarre `npx decap-server` sur le port 8081
3. Démarre le serveur de développement Eleventy
4. Accédez au CMS à : `http://localhost:{PORT}/admin/`
   - Le port est détecté automatiquement (généralement 8080, mais peut varier si le port est utilisé)
   - Vérifiez la sortie de la console pour l'URL réelle

### Génération manuelle de configuration

```bash
npm run cms:config           # Mode production (sans backend local)
npm run cms:config -- --local # Mode local (avec backend local)
```

**Note** : La configuration est auto-générée lors de `npm run build` et `npm run start-cms`

## Fonctionnalités clés

- **Entrée bilingue** : Ajoutez des ressources en EN et FR avec des onglets de langue
- **Bascule automatique** : Liaison inter-langues générée automatiquement
- **Disponibilité linguistique** : Marquez les ressources comme "both", "en" ou "fr"
- **Organisation par sujet** : 6 sujets avec étiquettes complètes dans CMS, converties en clés dans collections
- **Ressources parent/enfant** : Créer des collections de ressources hiérarchiques (parent avec enfants associés)
- **Contrôles d'affichage** : Filtrer les ressources par sujet ou activer "Group by Topic" pour affichage organisé
- **Indicateur de liens internes** : Indiquez les ressources du réseau du GC uniquement
- **Flux de travail de pull request** : Les modifications créent des PR pour révision avant déploiement
- **Attribution individuelle** : Les comptes GitHub fournissent une paternité claire des modifications

## Documentation

Consultez la documentation complète :

- **Détails de mise en œuvre** : `/docs/implementation/decap-cms-implementation.md`
- **Guide de configuration rapide** : `/DECAP-CMS-SETUP.md`
- **Documentation Decap CMS** : [decapcms.org/docs](https://decapcms.org/docs/)

